(self.webpackChunkmaarchCourrier=self.webpackChunkmaarchCourrier||[]).push([[7802],{57802:(ee,O,s)=>{s.r(O),s.d(O,{InstallerModule:()=>te});var W=s(9219),B=s(73722),H=s(60635),j=s(50140),A=s(15861),y=s(45983),f=s(22096),m=s(99397),v=s(26306),t=s(54548),d=s(71365),I=s(96122);let S=(()=>{class n{constructor(){this.steps=[]}setStep(e){this.steps.push(e)}isStepAlreadyLaunched(e){return this.steps.filter(r=>e===r.idStep).length>0}static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac})}return n})();var _=s(3219),P=s(45903),g=s(47454),b=s(23776),M=s(95965),N=s(257),C=s(1838);function Q(n,l){1&n&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275text(1,"..."),t.\u0275\u0275elementContainerEnd())}function X(n,l){1&n&&t.\u0275\u0275element(0,"i",16)}function Z(n,l){1&n&&t.\u0275\u0275element(0,"i",17)}function Y(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"div",18),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&n){const e=t.\u0275\u0275nextContext().$implicit;t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" ",e.msgErr," ")}}function J(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"mat-list-item")(1,"div",11)(2,"span",12),t.\u0275\u0275text(3),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(4,Q,2,0,"ng-container",10),t.\u0275\u0275text(5,"\xa0 "),t.\u0275\u0275template(6,X,1,0,"i",13)(7,Z,1,0,"i",14)(8,Y,2,1,"div",15),t.\u0275\u0275elementEnd()()),2&n){const e=l.$implicit;t.\u0275\u0275advance(),t.\u0275\u0275classProp("endStep","OK"===e.state||"KO"===e.state)("currentStep","inProgress"===e.state),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(e.label),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf","inProgress"===e.state),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf","OK"===e.state),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf","KO"===e.state),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",""!==e.msgErr)}}function tt(n,l){if(1&n){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",23),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(a.goToInstance())}),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()}2&n&&(t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"lang.goToNewInstance")))}function et(n,l){1&n&&(t.\u0275\u0275elementStart(0,"button",24),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&n&&(t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"lang.cancel")))}function nt(n,l){if(1&n&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275element(1,"span",19),t.\u0275\u0275elementStart(2,"div",20),t.\u0275\u0275template(3,tt,3,3,"button",21)(4,et,3,3,"button",22),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd()),2&n){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",!e.isInstallError()&&e.isInstallComplete()),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",e.isInstallError()||!e.isInstallBegin())}}let at=(()=>{class n{constructor(e,r,a,i,p,c,h){this.translate=e,this.data=r,this.dialogRef=a,this.http=i,this.installerService=p,this.notify=c,this.authService=h,this.steps=[],this.customId="",this.disableAnimation=!0}ngOnInit(){var e=this;return(0,A.Z)(function*(){e.initSteps()})()}ngAfterViewInit(){setTimeout(()=>this.disableAnimation=!1)}launchInstall(){var e=this;return(0,A.Z)(function*(){let r;for(let a=0;a<e.data.length&&(e.steps[a].state="inProgress",r=yield e.doStep(a),r);a++);})()}initSteps(){this.data.forEach((e,r)=>{0===r?this.customId=e.body.customId:e.body.customId=this.customId,this.steps.push({idStep:e.idStep,label:e.description,state:"",msgErr:""})})}doStep(e){return new Promise(r=>{this.installerService.isStepAlreadyLaunched(this.data[e].idStep)?(this.steps[e].state="OK",r(!0)):this.http[this.data[e].route.method.toLowerCase()](this.data[e].route.url,this.data[e].body).pipe((0,m.b)(a=>{this.steps[e].state="OK",this.installerService.setStep(this.steps[e]),r(!0)}),(0,v.K)(a=>(this.steps[e].state="KO",this.steps[e].msgErr=void 0!==a.error.lang?this.translate.instant("lang."+a.error.lang):a.error.errors,r(!1),(0,f.of)(!1)))).subscribe()})}isInstallBegin(){return this.steps.filter(e=>""===e.state).length!==this.steps.length}isInstallComplete(){return 0===this.steps.filter(e=>""===e.state).length}isInstallError(){return this.steps.filter(e=>"KO"===e.state).length>0}goToInstance(){this.http.request("DELETE","../rest/installer/lock",{body:{customId:this.customId}}).pipe((0,m.b)(e=>{this.authService.noInstall=!1,window.location.href=e.url,this.dialogRef.close("ok")}),(0,v.K)(e=>(this.notify.handleSoftErrors(e),(0,f.of)(!1)))).subscribe()}static#t=this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(d.sK),t.\u0275\u0275directiveInject(y.MAT_LEGACY_DIALOG_DATA),t.\u0275\u0275directiveInject(y.MatLegacyDialogRef),t.\u0275\u0275directiveInject(I.HttpClient),t.\u0275\u0275directiveInject(S),t.\u0275\u0275directiveInject(_.g),t.\u0275\u0275directiveInject(P.e))};static#e=this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-install-action"]],decls:16,vars:10,consts:[[1,"mat-dialog-content-container"],["mat-dialog-content",""],["hideToggle","","expanded",""],[1,"launch-action"],["color","primary",1,"text-center"],["mat-raised-button","","type","button","color","primary",2,"font-size","25px","padding","20px",3,"click"],[1,"far","fa-hdd"],[3,"expanded"],["installStepAction",""],[4,"ngFor","ngForOf"],[4,"ngIf"],["mat-line","",1,"step"],[1,"stepLabel"],["class","fa fa-check","style","color: green",4,"ngIf"],["class","fa fa-times","style","color: red",4,"ngIf"],["class","alert-message alert-message-danger","role","alert","style","margin-top: 30px;min-width: 100%;",4,"ngIf"],[1,"fa","fa-check",2,"color","green"],[1,"fa","fa-times",2,"color","red"],["role","alert",1,"alert-message","alert-message-danger",2,"margin-top","30px","min-width","100%"],[1,"divider-modal"],["mat-dialog-actions","",1,"actions"],["mat-raised-button","","mat-button","","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","mat-button","",3,"mat-dialog-close",4,"ngIf"],["mat-raised-button","","mat-button","","color","primary",3,"click"],["mat-raised-button","","mat-button","",3,"mat-dialog-close"]],template:function(r,a){if(1&r){const i=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"mat-accordion")(3,"mat-expansion-panel",2)(4,"div",3)(5,"h2",4),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"button",5),t.\u0275\u0275listener("click",function(){return t.\u0275\u0275restoreView(i),t.\u0275\u0275reference(13).open(),t.\u0275\u0275resetView(a.launchInstall())}),t.\u0275\u0275element(9,"i",6),t.\u0275\u0275text(10),t.\u0275\u0275pipe(11,"translate"),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(12,"mat-expansion-panel",7,8),t.\u0275\u0275template(14,J,9,9,"mat-list-item",9),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275template(15,nt,5,2,"ng-container",10),t.\u0275\u0275elementEnd()}2&r&&(t.\u0275\u0275advance(),t.\u0275\u0275property("@.disabled",a.disableAnimation),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(7,6,"lang.almostThere")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(11,8,"lang.launchInstall")," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("expanded",!1),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",a.steps),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",a.isInstallComplete()||a.isInstallError()||!a.isInstallBegin()))},dependencies:[g.NgForOf,g.NgIf,b.MatLegacyButton,M.MatLine,N.MatAccordion,N.MatExpansionPanel,y.MatLegacyDialogClose,y.MatLegacyDialogContent,y.MatLegacyDialogActions,C.MatLegacyListItem,d.X$],styles:[".step[_ngcontent-%COMP%]{opacity:.5;transition:all .2s}.step[_ngcontent-%COMP%]   .stepLabel[_ngcontent-%COMP%]{transition:all .2s}.currentStep[_ngcontent-%COMP%]{opacity:1;transition:all .2s}.currentStep[_ngcontent-%COMP%]   .stepLabel[_ngcontent-%COMP%]{font-size:150%;transition:all .2s}.endStep[_ngcontent-%COMP%]{opacity:1}.mat-expansion-panel[_ngcontent-%COMP%]{box-shadow:none}.launch-action[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]})}return n})();var T=s(32181),rt=s(75231),ot=s(72359),G=s(38719),it=s(33198),z=s(38139),E=s(46871),x=s(77068),o=s(25181),w=s(32118),u=s(17092),D=s(60171),U=s(3367),st=s(11107);function lt(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"mat-option",14),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&n){const e=l.$implicit;t.\u0275\u0275property("value",e),t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(2,2,"lang."+e+"Full")," ")}}function pt(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"mat-list-item"),t.\u0275\u0275element(1,"mat-icon",15),t.\u0275\u0275elementStart(2,"div",16),t.\u0275\u0275text(3),t.\u0275\u0275elementStart(4,"small",17),t.\u0275\u0275text(5),t.\u0275\u0275elementEnd()()()),2&n){const e=l.$implicit;t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1("",e.label," "),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(e.id)}}function ct(n,l){if(1&n&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementStart(1,"mat-list")(2,"div",9),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(5,pt,6,2,"mat-list-item",10),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(6,"mat-divider"),t.\u0275\u0275elementContainerEnd()),2&n){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(4,2,"lang.instancesList")," : "),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",e.customs)}}function mt(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"mat-list-item"),t.\u0275\u0275element(1,"mat-icon",18),t.\u0275\u0275elementStart(2,"div",16),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd()()),2&n){const e=l.$implicit;t.\u0275\u0275advance(),t.\u0275\u0275classMap(e.icon),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(4,3,e.desc))}}const dt=n=>({value1:n});let ut=(()=>{class n{constructor(e,r,a,i,p){this.translate=e,this.http=r,this.notify=a,this._formBuilder=i,this.authService=p,this.langs=[],this.appVersion=w.N.BASE_VERSION,this.steps=[{icon:"fas fa-check-square",desc:"lang.prerequisiteCheck"},{icon:"fa fa-database",desc:"lang.databaseCreation"},{icon:"fa fa-database",desc:"lang.dataSampleCreation"},{icon:"fa fa-hdd",desc:"lang.docserverCreation"},{icon:"fas fa-tools",desc:"lang.stepCustomizationActionDesc"},{icon:"fa fa-user",desc:"lang.adminUserCreation"}],this.customs=[]}ngOnInit(){this.stepFormGroup=this._formBuilder.group({lang:["fr",o.Validators.required]}),this.getLang(),this.authService.noInstall||this.getCustoms()}getLang(){this.http.get("../rest/languages").pipe((0,m.b)(e=>{this.langs=Object.keys(e.langs).filter(r=>"nl"!==r)}),(0,v.K)(e=>(this.notify.handleSoftErrors(e),(0,f.of)(!1)))).subscribe()}changeLang(e){this.translate.use(e)}getCustoms(){this.http.get("../rest/installer/customs").pipe((0,m.b)(e=>{this.customs=e.customs}),(0,v.K)(e=>(this.notify.handleSoftErrors(e),(0,f.of)(!1)))).subscribe()}initStep(){return!1}getInfoToInstall(){return[]}static#t=this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(d.sK),t.\u0275\u0275directiveInject(I.HttpClient),t.\u0275\u0275directiveInject(_.g),t.\u0275\u0275directiveInject(o.UntypedFormBuilder),t.\u0275\u0275directiveInject(P.e))};static#e=this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-welcome"]],decls:32,vars:25,consts:[[1,"stepContent"],[1,"stepContentTitle"],[2,"text-align","center"],["svgIcon","maarchLogoFull",1,"maarchLogoFull"],[2,"width","850px","margin","auto",3,"formGroup"],["appearance","outline","floatLabel","never"],["formControlName","lang","required","",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["mat-subheader",""],[4,"ngFor","ngForOf"],["mat-raised-button","","color","primary","href","https://community.maarch.org/","target","_blank"],["mat-raised-button","","color","primary","href","http://www.maarch.com","target","_blank"],[2,"font-style","italic","padding-top","30px","text-align","right",3,"innerHTML"],[3,"value"],["mat-list-icon","","color","primary",1,"fas","fa-box-open"],["mat-line",""],[2,"color","#666"],["mat-list-icon","","color","primary"]],template:function(r,a){1&r&&(t.\u0275\u0275elementStart(0,"div",0)(1,"h2",1),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"div",2),t.\u0275\u0275element(5,"mat-icon",3),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"form",4)(7,"mat-form-field",5)(8,"mat-label"),t.\u0275\u0275text(9),t.\u0275\u0275pipe(10,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(11,"mat-select",6),t.\u0275\u0275listener("selectionChange",function(p){return a.changeLang(p.value)}),t.\u0275\u0275template(12,lt,3,4,"mat-option",7),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275element(13,"mat-divider"),t.\u0275\u0275template(14,ct,7,4,"ng-container",8),t.\u0275\u0275elementStart(15,"mat-list")(16,"div",9),t.\u0275\u0275text(17),t.\u0275\u0275pipe(18,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(19,mt,5,5,"mat-list-item",10),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(20,"mat-divider"),t.\u0275\u0275elementStart(21,"p"),t.\u0275\u0275text(22),t.\u0275\u0275pipe(23,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(24,"a",11),t.\u0275\u0275text(25," community.maarch.org "),t.\u0275\u0275elementEnd(),t.\u0275\u0275text(26),t.\u0275\u0275pipe(27,"translate"),t.\u0275\u0275elementStart(28,"a",12),t.\u0275\u0275text(29," www.maarch.com "),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(30,"p",13),t.\u0275\u0275pipe(31,"translate"),t.\u0275\u0275elementEnd()),2&r&&(t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind2(3,10,"lang.welcomeApp",t.\u0275\u0275pureFunction1(23,dt,a.appVersion))," !"),t.\u0275\u0275advance(4),t.\u0275\u0275property("formGroup",a.stepFormGroup),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(10,13,"lang.chooseAppLanguage")," : "),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",a.langs),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",a.customs.length>0),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(18,15,"lang.installDescription")," : "),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",a.steps),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(23,17,"lang.externalInfoSite")," : "),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(27,19,"lang.or")," "),t.\u0275\u0275advance(4),t.\u0275\u0275property("innerHTML",t.\u0275\u0275pipeBind1(31,21,"lang.maarchLicenceInstall"),t.\u0275\u0275sanitizeHtml))},dependencies:[g.NgForOf,g.NgIf,o.\u0275NgNoValidate,o.NgControlStatus,o.NgControlStatusGroup,o.RequiredValidator,o.FormGroupDirective,o.FormControlName,u.MatLegacyFormField,u.MatLegacyLabel,D.MatLegacySelect,U.MatLegacyOption,b.MatLegacyAnchor,M.MatLine,E.MatIcon,C.MatLegacyList,C.MatLegacyListItem,C.MatLegacyListIconCssMatStyler,C.MatLegacyListSubheaderCssMatStyler,st.MatDivider,d.X$],styles:[".stepContent[_ngcontent-%COMP%]{margin:auto}.stepContent[_ngcontent-%COMP%]   .stepContentTitle[_ngcontent-%COMP%]{color:var(--maarch-color-primary);margin-bottom:30px;border-bottom:solid 1px;padding:0}.stepContent[_ngcontent-%COMP%]   .maarchLogoFull[_ngcontent-%COMP%]{width:300px;height:100px}.stepContent[_ngcontent-%COMP%]   .mat-divider[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px}.link[_ngcontent-%COMP%]{text-decoration:underline;color:var(--maarch-color-primary)!important}"]})}return n})();var gt=s(19162),q=s(46780),ht=s(91939);const ft=["packageItem"];function vt(n,l){1&n&&(t.\u0275\u0275element(0,"app-maarch-message",9),t.\u0275\u0275pipe(1,"translate")),2&n&&t.\u0275\u0275property("mode","warning")("content",t.\u0275\u0275pipeBind1(1,2,"lang.isWarningPackage"))}function Ct(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"mat-grid-tile")(1,"mat-list-item"),t.\u0275\u0275element(2,"mat-icon",14),t.\u0275\u0275elementStart(3,"div",15),t.\u0275\u0275text(4),t.\u0275\u0275pipe(5,"translate"),t.\u0275\u0275element(6,"i",16,17),t.\u0275\u0275pipe(8,"translate"),t.\u0275\u0275elementEnd()()()),2&n){const e=l.$implicit;t.\u0275\u0275advance(2),t.\u0275\u0275classMapInterpolate1("fa iconCheckPackage icon_",e.state,""),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(5,7,"lang.install_"+e.label)," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("id",e.label)("matTooltip",t.\u0275\u0275pipeBind1(8,9,"lang.install_"+e.label+"_desc"))("matTooltipClass","ok"!==e.state?"tooltip-"+e.state:"")}}function _t(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"mat-list",10)(1,"div",11),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"mat-grid-list",12),t.\u0275\u0275template(5,Ct,9,11,"mat-grid-tile",13),t.\u0275\u0275elementEnd()()),2&n){const e=l.$implicit,r=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,2,"lang."+e.key)),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",r.packagesList[e.key])}}let bt=(()=>{class n{constructor(e,r,a,i,p){this.translate=e,this.http=r,this.notify=a,this._formBuilder=i,this.functionsService=p,this.prerequisites={},this.packagesList={general:[{label:"phpVersionValid",required:!0},{label:"writable",required:!0}],tools:[{label:"unoconv",required:!0},{label:"netcatOrNmap",required:!0},{label:"pgsql",required:!0},{label:"curl",required:!0},{label:"zip",required:!0},{label:"wkhtmlToPdf",required:!0},{label:"imagick",required:!0}],phpExtensions:[{label:"fileinfo",required:!0},{label:"pdoPgsql",required:!0},{label:"gd",required:!0},{label:"mbstring",required:!0},{label:"json",required:!0},{label:"gettext",required:!0},{label:"xml",required:!0}],phpConfiguration:[{label:"errorReporting",required:!0},{label:"displayErrors",required:!0}]},this.docMaarchUrl=this.functionsService.getDocBaseUrl()+"/guat/guat_prerequisites/home.html"}ngOnInit(){this.stepFormGroup=this._formBuilder.group({firstCtrl:["",o.Validators.required]}),this.getStepData()}getStepData(){this.http.get("../rest/installer/prerequisites").pipe((0,m.b)(e=>{this.prerequisites=e.prerequisites,Object.keys(this.packagesList).forEach(r=>{this.packagesList[r].forEach((a,i)=>{this.packagesList[r][i].state="displayErrors"===this.packagesList[r][i].label?this.prerequisites[this.packagesList[r][i].label]?"ok":"warning":this.prerequisites[this.packagesList[r][i].label]?"ok":"ko","phpVersionValid"===this.packagesList[r][i].label&&this.translate.setTranslation(this.translate.getDefaultLang(),{lang:{install_phpVersionValid_desc:this.translate.instant("lang.currentVersion")+" : "+this.prerequisites.phpVersion}},!0)})}),this.stepFormGroup.controls.firstCtrl.setValue(this.checkStep()),this.stepFormGroup.controls.firstCtrl.markAsUntouched()}),(0,v.K)(e=>(this.notify.handleSoftErrors(e),(0,f.of)(!1)))).subscribe()}initStep(){Object.keys(this.packagesList).forEach(r=>{this.packagesList[r].forEach((a,i)=>{"ko"===this.packagesList[r][i].state&&this.packageItem.toArray().filter(p=>p._elementRef.nativeElement.id===this.packagesList[r][i].label)[0].toggle()})})}checkStep(){let e="success";return Object.keys(this.packagesList).forEach(r=>{this.packagesList[r].forEach(a=>{"ko"===a.state&&(e="")})}),e}isValidStep(){return void 0!==this.stepFormGroup&&"success"===this.stepFormGroup.controls.firstCtrl.value}getFormGroup(){return this.stepFormGroup}getInfoToInstall(){return[]}isWarningPackage(){return"warning"===this.packagesList.phpConfiguration.find(r=>"displayErrors"===r.label).state}static#t=this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(d.sK),t.\u0275\u0275directiveInject(I.HttpClient),t.\u0275\u0275directiveInject(_.g),t.\u0275\u0275directiveInject(o.UntypedFormBuilder),t.\u0275\u0275directiveInject(G.d))};static#e=this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-prerequisite"]],viewQuery:function(r,a){if(1&r&&t.\u0275\u0275viewQuery(ft,5),2&r){let i;t.\u0275\u0275queryRefresh(i=t.\u0275\u0275loadQuery())&&(a.packageItem=i)}},decls:17,vars:15,consts:[[1,"stepContent"],[1,"stepContentTitle"],[1,"fas","fa-check-square"],["role","alert",1,"alert-message","alert-message-info",2,"margin-top","30px","min-width","100%"],["target","_blank",1,"link",3,"href"],[3,"mode","content",4,"ngIf"],["style","background: white;",4,"ngFor","ngForOf"],[2,"text-align","center"],["mat-raised-button","","type","button","color","primary",3,"click"],[3,"mode","content"],[2,"background","white"],["mat-subheader",""],["cols","3","rowHeight","50px"],[4,"ngFor","ngForOf"],["mat-list-icon",""],["mat-line","",1,"packageName"],["matTooltipPosition","right",1,"fa","fa-info-circle",3,"id","matTooltip","matTooltipClass"],["packageItem","matTooltip"]],template:function(r,a){1&r&&(t.\u0275\u0275elementStart(0,"div",0)(1,"h2",1),t.\u0275\u0275element(2,"i",2),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div",3),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementStart(8,"a",4),t.\u0275\u0275text(9),t.\u0275\u0275elementEnd()(),t.\u0275\u0275template(10,vt,2,4,"app-maarch-message",5)(11,_t,6,4,"mat-list",6),t.\u0275\u0275pipe(12,"keyvalue"),t.\u0275\u0275elementStart(13,"div",7)(14,"button",8),t.\u0275\u0275listener("click",function(){return a.getStepData()}),t.\u0275\u0275text(15),t.\u0275\u0275pipe(16,"translate"),t.\u0275\u0275elementEnd()()()),2&r&&(t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(4,7,"lang.prerequisite"),""),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(7,9,"lang.stepPrerequisite_desc")," : "),t.\u0275\u0275advance(2),t.\u0275\u0275propertyInterpolate("href",a.docMaarchUrl,t.\u0275\u0275sanitizeUrl),t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(a.docMaarchUrl),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",a.isWarningPackage()),t.\u0275\u0275advance(),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind1(12,11,a.packagesList)),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(16,13,"lang.updateInformations")))},dependencies:[g.NgForOf,g.NgIf,gt.MatLegacyTooltip,b.MatLegacyButton,q.MatGridList,q.MatGridTile,M.MatLine,E.MatIcon,C.MatLegacyList,C.MatLegacyListItem,C.MatLegacyListIconCssMatStyler,C.MatLegacyListSubheaderCssMatStyler,ht.W,g.KeyValuePipe,d.X$],styles:['.stepContent[_ngcontent-%COMP%]{margin:auto}.stepContent[_ngcontent-%COMP%]   .stepContentTitle[_ngcontent-%COMP%]{color:var(--maarch-color-primary);margin-bottom:30px;border-bottom:solid 1px;padding:0}.packageItem[_ngcontent-%COMP%]{flex:1!important}.iconCheckPackage[_ngcontent-%COMP%]{background:white;font-size:15px!important;display:flex;align-items:center;justify-content:center;padding:10px;border-radius:20px;height:35px;width:35px}.icon_ok[_ngcontent-%COMP%]{color:green}.icon_ok[_ngcontent-%COMP%]:before{content:"\\f111"}.icon_warning[_ngcontent-%COMP%]{color:orange}.icon_warning[_ngcontent-%COMP%]:before{content:"\\f111"}.icon_ko[_ngcontent-%COMP%]{color:red}.icon_ko[_ngcontent-%COMP%]:before{content:"\\f111"}.link[_ngcontent-%COMP%]{text-decoration:underline;color:var(--maarch-color-primary)!important}.packageName[_ngcontent-%COMP%]{font-size:120%!important;white-space:normal!important}.packageName[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:help;opacity:.5;color:var(--maarch-color-primary)}  .tooltip-ko{background:#b71c1c;font-size:14px}  .tooltip-warning{background:orange;font-size:14px}']})}return n})();var L=s(55055);function yt(n,l){1&n&&(t.\u0275\u0275elementStart(0,"div",18),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&n&&(t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(2,1,"lang.stepEmptyDb")," "))}function It(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"mat-option",19),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&n){const e=l.$implicit;t.\u0275\u0275property("value",e),t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" ",e," ")}}let St=(()=>{class n{constructor(e,r,a,i,p,c){this.translate=e,this.http=r,this._formBuilder=a,this.notify=i,this.functionsService=p,this.installerService=c,this.nextStep=new t.EventEmitter,this.hide=!0,this.connectionState=!1,this.dbExist=!1,this.dataFiles=[];const h=[o.Validators.pattern(/^[^\;\" \\]+$/),o.Validators.required],F=[o.Validators.pattern(/^[^ ]+$/),o.Validators.required];this.stepFormGroup=this._formBuilder.group({dbHostCtrl:["localhost",o.Validators.required],dbLoginCtrl:["",F],dbPortCtrl:["5432",o.Validators.required],dbPasswordCtrl:["",F],dbNameCtrl:["",h],dbSampleCtrl:["data_fr",o.Validators.required],stateStep:["",o.Validators.required]})}ngOnInit(){this.stepFormGroup.controls.dbHostCtrl.valueChanges.pipe((0,m.b)(()=>this.stepFormGroup.controls.stateStep.setValue(""))).subscribe(),this.stepFormGroup.controls.dbLoginCtrl.valueChanges.pipe((0,m.b)(()=>this.stepFormGroup.controls.stateStep.setValue(""))).subscribe(),this.stepFormGroup.controls.dbPortCtrl.valueChanges.pipe((0,m.b)(()=>this.stepFormGroup.controls.stateStep.setValue(""))).subscribe(),this.stepFormGroup.controls.dbPasswordCtrl.valueChanges.pipe((0,m.b)(()=>this.stepFormGroup.controls.stateStep.setValue(""))).subscribe(),this.stepFormGroup.controls.dbNameCtrl.valueChanges.pipe((0,m.b)(()=>this.stepFormGroup.controls.stateStep.setValue(""))).subscribe(),this.getDataFiles()}getDataFiles(){this.http.get("../rest/installer/sqlDataFiles").pipe((0,m.b)(e=>{this.dataFiles=e.dataFiles}),(0,v.K)(e=>(this.notify.handleSoftErrors(e),(0,f.of)(!1)))).subscribe()}isValidConnection(){return!1}initStep(){this.installerService.isStepAlreadyLaunched("database")&&this.stepFormGroup.disable()}checkConnection(){this.http.get("../rest/installer/databaseConnection",{observe:"response",params:{server:this.stepFormGroup.controls.dbHostCtrl.value,port:this.stepFormGroup.controls.dbPortCtrl.value,user:this.stepFormGroup.controls.dbLoginCtrl.value,password:this.stepFormGroup.controls.dbPasswordCtrl.value,name:this.stepFormGroup.controls.dbNameCtrl.value}}).pipe((0,m.b)(r=>{this.dbExist=200===r.status,this.notify.success(this.translate.instant("lang.rightInformations")),this.stepFormGroup.controls.stateStep.setValue("success"),this.nextStep.emit()}),(0,v.K)(r=>(this.dbExist=!1,this.notify.error(this.translate.instant("Given database has tables"===r.error.errors?"lang.dbNotEmpty":"lang.badInformations")),this.stepFormGroup.markAllAsTouched(),this.stepFormGroup.controls.stateStep.setValue(""),(0,f.of)(!1)))).subscribe()}checkStep(){return this.stepFormGroup.valid}isValidStep(){return!!this.installerService.isStepAlreadyLaunched("database")||void 0!==this.stepFormGroup&&this.stepFormGroup.valid}isEmptyConnInfo(){return this.stepFormGroup.controls.dbHostCtrl.invalid||this.stepFormGroup.controls.dbPortCtrl.invalid||this.stepFormGroup.controls.dbLoginCtrl.invalid||this.stepFormGroup.controls.dbPasswordCtrl.invalid||this.stepFormGroup.controls.dbNameCtrl.invalid}getFormGroup(){return!!this.installerService.isStepAlreadyLaunched("database")||this.stepFormGroup}getInfoToInstall(){return[{idStep:"database",body:{server:this.stepFormGroup.controls.dbHostCtrl.value,port:this.stepFormGroup.controls.dbPortCtrl.value,user:this.stepFormGroup.controls.dbLoginCtrl.value,password:this.stepFormGroup.controls.dbPasswordCtrl.value,name:this.stepFormGroup.controls.dbNameCtrl.value,data:this.stepFormGroup.controls.dbSampleCtrl.value},route:{method:"POST",url:"../rest/installer/database"},description:this.translate.instant("lang.stepDatabaseActionDesc"),installPriority:2}]}static#t=this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(d.sK),t.\u0275\u0275directiveInject(I.HttpClient),t.\u0275\u0275directiveInject(o.UntypedFormBuilder),t.\u0275\u0275directiveInject(_.g),t.\u0275\u0275directiveInject(G.d),t.\u0275\u0275directiveInject(S))};static#e=this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-database"]],outputs:{nextStep:"nextStep"},decls:47,vars:35,consts:[[1,"stepContent"],[1,"stepContentTitle"],[1,"fa","fa-database"],["role","alert",1,"alert-message","alert-message-info",2,"margin-top","30px","min-width","100%"],[2,"width","850px","margin","auto",3,"formGroup"],["appearance","outline"],["matInput","","formControlName","dbHostCtrl","required",""],["matInput","","formControlName","dbPortCtrl","required",""],["matInput","","formControlName","dbLoginCtrl","required",""],["matInput","","formControlName","dbPasswordCtrl","required","",3,"type"],["mat-icon-button","","matSuffix","","color","primary",3,"click"],["matInput","","formControlName","dbNameCtrl","maxlength","50","required",""],["class","alert-message alert-message-info","role","alert","style","margin-top: 0px;min-width: 100%;",4,"ngIf"],["appearance","outline","floatLabel","never"],["formControlName","dbSampleCtrl"],[3,"value",4,"ngFor","ngForOf"],[2,"text-align","center"],["mat-raised-button","","type","button","color","primary",3,"disabled","click"],["role","alert",1,"alert-message","alert-message-info",2,"margin-top","0px","min-width","100%"],[3,"value"]],template:function(r,a){1&r&&(t.\u0275\u0275elementStart(0,"div",0)(1,"h2",1),t.\u0275\u0275element(2,"i",2),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div",3),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"form",4)(9,"mat-form-field",5)(10,"mat-label"),t.\u0275\u0275text(11),t.\u0275\u0275pipe(12,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(13,"input",6),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(14,"mat-form-field",5)(15,"mat-label"),t.\u0275\u0275text(16),t.\u0275\u0275pipe(17,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(18,"input",7),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(19,"mat-form-field",5)(20,"mat-label"),t.\u0275\u0275text(21),t.\u0275\u0275pipe(22,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(23,"input",8),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(24,"mat-form-field",5)(25,"mat-label"),t.\u0275\u0275text(26),t.\u0275\u0275pipe(27,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(28,"input",9),t.\u0275\u0275elementStart(29,"button",10),t.\u0275\u0275listener("click",function(){return a.hide=!a.hide}),t.\u0275\u0275element(30,"mat-icon"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(31,"mat-form-field",5)(32,"mat-label"),t.\u0275\u0275text(33),t.\u0275\u0275pipe(34,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(35,"input",11),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(36,yt,3,3,"div",12),t.\u0275\u0275elementStart(37,"mat-form-field",13)(38,"mat-label"),t.\u0275\u0275text(39),t.\u0275\u0275pipe(40,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(41,"mat-select",14),t.\u0275\u0275template(42,It,2,2,"mat-option",15),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(43,"div",16)(44,"button",17),t.\u0275\u0275listener("click",function(){return a.checkConnection()}),t.\u0275\u0275text(45),t.\u0275\u0275pipe(46,"translate"),t.\u0275\u0275elementEnd()()()()),2&r&&(t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(4,17,"lang.database"),""),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(7,19,"lang.stepDatabase_desc")," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("formGroup",a.stepFormGroup),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(12,21,"lang.host")),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(17,23,"lang.port")),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(22,25,"lang.user")),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(27,27,"lang.password")),t.\u0275\u0275advance(2),t.\u0275\u0275property("type",a.hide?"password":"text"),t.\u0275\u0275advance(2),t.\u0275\u0275classMapInterpolate1("fa ",a.hide?"fa-eye-slash":"fa-eye",""),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(34,29,"lang.dbName")),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",a.dbExist),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(40,31,"lang.dbSample")),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",a.dataFiles),t.\u0275\u0275advance(2),t.\u0275\u0275property("disabled",a.isEmptyConnInfo()||a.stepFormGroup.controls.dbHostCtrl.disabled),t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(46,33,"lang.checkInformations")," "))},dependencies:[g.NgForOf,g.NgIf,o.\u0275NgNoValidate,o.DefaultValueAccessor,o.NgControlStatus,o.NgControlStatusGroup,o.RequiredValidator,o.MaxLengthValidator,o.FormGroupDirective,o.FormControlName,u.MatLegacyFormField,u.MatLegacyLabel,u.MatLegacySuffix,D.MatLegacySelect,U.MatLegacyOption,L.MatLegacyInput,b.MatLegacyButton,E.MatIcon,d.X$],styles:[".stepContent[_ngcontent-%COMP%]{margin:auto}.stepContent[_ngcontent-%COMP%]   .stepContentTitle[_ngcontent-%COMP%]{color:var(--maarch-color-primary);margin-bottom:30px;border-bottom:solid 1px;padding:0}"]})}return n})(),xt=(()=>{class n{constructor(e,r,a,i,p){this.translate=e,this._formBuilder=r,this.notify=a,this.http=i,this.installerService=p,this.nextStep=new t.EventEmitter;const c=[o.Validators.pattern(/^[^'<>|*:?]+$/),o.Validators.required];this.stepFormGroup=this._formBuilder.group({docserversPath:["/opt/maarch/docservers/",c],stateStep:["",o.Validators.required]}),this.stepFormGroup.controls.docserversPath.valueChanges.pipe((0,m.b)(()=>this.stepFormGroup.controls.stateStep.setValue(""))).subscribe()}isValidStep(){return!!this.installerService.isStepAlreadyLaunched("docserver")||void 0!==this.stepFormGroup&&this.stepFormGroup.valid}initStep(){this.installerService.isStepAlreadyLaunched("docserver")&&this.stepFormGroup.disable()}getFormGroup(){return!!this.installerService.isStepAlreadyLaunched("docserver")||this.stepFormGroup}checkAvailability(){this.http.get("../rest/installer/docservers",{params:{path:this.stepFormGroup.controls.docserversPath.value}}).pipe((0,m.b)(()=>{this.notify.success(this.translate.instant("lang.rightInformations")),this.stepFormGroup.controls.stateStep.setValue("success"),this.nextStep.emit()}),(0,v.K)(()=>(this.notify.error(this.translate.instant("lang.pathUnreacheable")),this.stepFormGroup.controls.stateStep.setValue(""),(0,f.of)(!1)))).subscribe()}getInfoToInstall(){return[{idStep:"docserver",body:{path:this.stepFormGroup.controls.docserversPath.value},route:{method:"POST",url:"../rest/installer/docservers"},description:this.translate.instant("lang.stepDocserversActionDesc"),installPriority:3}]}static#t=this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(d.sK),t.\u0275\u0275directiveInject(o.UntypedFormBuilder),t.\u0275\u0275directiveInject(_.g),t.\u0275\u0275directiveInject(I.HttpClient),t.\u0275\u0275directiveInject(S))};static#e=this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-docservers"]],outputs:{nextStep:"nextStep"},decls:20,vars:14,consts:[[1,"stepContent"],[1,"stepContentTitle"],[1,"fa","fa-hdd"],["role","alert",1,"alert-message","alert-message-info",2,"margin-top","30px","min-width","100%"],[2,"width","850px","margin","auto",3,"formGroup"],["appearance","outline",2,"color","initial"],["matInput","","formControlName","docserversPath"],["matSuffix",""],[2,"text-align","center"],["mat-raised-button","","type","button","color","primary",3,"disabled","click"]],template:function(r,a){1&r&&(t.\u0275\u0275elementStart(0,"div",0)(1,"h2",1),t.\u0275\u0275element(2,"i",2),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div",3),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"form",4)(9,"mat-form-field",5)(10,"mat-label"),t.\u0275\u0275text(11),t.\u0275\u0275pipe(12,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(13,"input",6),t.\u0275\u0275elementStart(14,"span",7),t.\u0275\u0275text(15,"/__CUSTOM_iD__/"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(16,"div",8)(17,"button",9),t.\u0275\u0275listener("click",function(){return a.checkAvailability()}),t.\u0275\u0275text(18),t.\u0275\u0275pipe(19,"translate"),t.\u0275\u0275elementEnd()()()()),2&r&&(t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(4,6,"lang.docserver"),""),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(7,8,"lang.stepDocserver_desc")," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("formGroup",a.stepFormGroup),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(12,10,"lang.docserverPath")),t.\u0275\u0275advance(6),t.\u0275\u0275property("disabled",!a.stepFormGroup.controls.docserversPath.valid),t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(19,12,"lang.checkInformations")))},dependencies:[o.\u0275NgNoValidate,o.DefaultValueAccessor,o.NgControlStatus,o.NgControlStatusGroup,o.FormGroupDirective,o.FormControlName,u.MatLegacyFormField,u.MatLegacyLabel,u.MatLegacySuffix,L.MatLegacyInput,b.MatLegacyButton,d.X$],styles:[".stepContent[_ngcontent-%COMP%]{margin:auto}.stepContent[_ngcontent-%COMP%]   .stepContentTitle[_ngcontent-%COMP%]{color:var(--maarch-color-primary);margin-bottom:30px;border-bottom:solid 1px;padding:0}"]})}return n})();var R=s(41297),Ft=s(27921),Et=s(83620),Mt=s(91787),Gt=s(12996);function Lt(n,l){1&n&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementContainerEnd()),2&n&&(t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(2,1,"lang.customAlreadyExist")," "))}function kt(n,l){1&n&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementContainerEnd()),2&n&&(t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(2,1,"lang.invalidCustomName")," "))}const Bt=()=>({value1:'"_", "-"'});function Pt(n,l){1&n&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementContainerEnd()),2&n&&(t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind2(2,1,"lang.onlySpecialCharAllowed",t.\u0275\u0275pureFunction0(4,Bt))," "))}const Tt=()=>({value1:"2"});function wt(n,l){1&n&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementContainerEnd()),2&n&&(t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind2(2,1,"lang.invalidLengthCustomName",t.\u0275\u0275pureFunction0(4,Tt))," "))}function Vt(n,l){if(1&n){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-card",20),t.\u0275\u0275listener("click",function(){const i=t.\u0275\u0275restoreView(e).$implicit,p=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(p.selectBg(i.url))}),t.\u0275\u0275elementEnd()}if(2&n){const e=l.$implicit,r=t.\u0275\u0275nextContext();t.\u0275\u0275styleProp("background","url("+e.url+")"),t.\u0275\u0275classProp("selected",e.url===r.stepFormGroup.controls.bodyLoginBackground.value)("disabled",r.stepFormGroup.controls.bodyLoginBackground.disabled)}}function Ot(n,l){if(1&n){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-card",21),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275reference(2);return t.\u0275\u0275resetView(a.click())}),t.\u0275\u0275elementStart(1,"input",22,23),t.\u0275\u0275listener("change",function(a){t.\u0275\u0275restoreView(e);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.uploadTrigger(a,"bg"))}),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(3,"i",24),t.\u0275\u0275elementEnd()}}let jt=(()=>{class n{constructor(e,r,a,i,p,c,h,F){this.translate=e,this._formBuilder=r,this.notify=a,this.sanitizer=i,this.scanPipe=p,this.http=c,this.installerService=h,this.functionsService=F,this.readonlyState=!1,this.backgroundList=[];const V=[o.Validators.pattern(/^[a-z0-9_\-]*$/),o.Validators.required,o.Validators.minLength(3)],k=this.functionsService.getDocBaseUrl();this.stepFormGroup=this._formBuilder.group({firstCtrl:["success",o.Validators.required],customId:[null,V],appName:[`Maarch Courrier ${w.N.BASE_VERSION}`,o.Validators.required],loginMessage:[`<span style="color:#24b0ed"><strong>D\xe9couvrez votre application via</strong></span>&nbsp;<a title="le guide de visite" href="${k}/guu/home.html" target="_blank"><span style="color:#f99830;"><strong>le guide de visite en ligne</strong></span></a>`],homeMessage:[`<p>D&eacute;couvrez <strong>Maarch Courrier ${w.N.BASE_VERSION}</strong> avec <a title="notre guide de visite" href="${k}" target="_blank"><span style="color:#f99830;"><strong>notre guide de visite en ligne</strong></span></a>.</p>`],bodyLoginBackground:["assets/bodylogin.jpg"],uploadedLogo:["../rest/images?image=logo"]}),this.backgroundList=Array.from({length:17}).map((ae,K)=>({filename:`${K+1}.jpg`,url:`assets/${K+1}.jpg`}))}ngOnInit(){this.checkCustomExist(),this.stepFormGroup.controls.customId.valueChanges.pipe((0,Ft.O)(""),(0,m.b)(()=>{this.stepFormGroup.controls.firstCtrl.setValue("")}),(0,Et.b)(500),(0,T.h)(e=>e.length>2),(0,T.h)(()=>null===this.stepFormGroup.controls.customId.errors||void 0===this.stepFormGroup.controls.customId.errors.pattern),(0,m.b)(()=>{this.checkCustomExist()})).subscribe()}initStep(){null===this.stepFormGroup.controls.customId.value&&this.stepFormGroup.controls.customId.setValue(this.appDatabase.getInfoToInstall()[0].body.name),this.installerService.isStepAlreadyLaunched("createCustom")&&this.installerService.isStepAlreadyLaunched("customization")?(this.stepFormGroup.disable(),this.readonlyState=!0,tinymce.remove(),this.initMce(!0)):this.installerService.isStepAlreadyLaunched("createCustom")?(this.stepFormGroup.controls.customId.disable(),this.stepFormGroup.controls.appName.disable(),this.stepFormGroup.controls.firstCtrl.disable()):this.installerService.isStepAlreadyLaunched("customization")?(this.stepFormGroup.controls.loginMessage.disable(),this.stepFormGroup.controls.homeMessage.disable(),this.stepFormGroup.controls.bodyLoginBackground.disable(),this.stepFormGroup.controls.uploadedLogo.disable(),this.readonlyState=!0,tinymce.remove(),this.initMce(!0)):(this.readonlyState=!1,this.initMce())}checkCustomExist(){this.http.get("../rest/installer/custom",{observe:"response",params:{customId:this.stepFormGroup.controls.customId.value}}).pipe((0,m.b)(e=>{null!==this.stepFormGroup.controls.customId.errors?delete this.stepFormGroup.controls.customId.errors.customExist:this.stepFormGroup.controls.firstCtrl.setValue("success")}),(0,v.K)(e=>(null!==e.error.errors.match(/^Custom already exists/g)?(this.stepFormGroup.controls.customId.setErrors({...this.stepFormGroup.controls.customId.errors,customExist:!0}),this.stepFormGroup.controls.customId.markAsTouched()):null!==e.error.errors.match(/^Unauthorized custom name/g)?(this.stepFormGroup.controls.customId.setErrors({...this.stepFormGroup.controls.customId.errors,invalidCustomName:!0}),this.stepFormGroup.controls.customId.markAsTouched()):this.notify.handleSoftErrors(e),(0,f.of)(!1)))).subscribe()}isValidStep(){return!(!this.installerService.isStepAlreadyLaunched("createCustom")||!this.installerService.isStepAlreadyLaunched("customization"))||void 0!==this.stepFormGroup&&this.stepFormGroup.valid}getFormGroup(){return!(!this.installerService.isStepAlreadyLaunched("createCustom")||!this.installerService.isStepAlreadyLaunched("customization"))||this.stepFormGroup}initMce(e=!1){tinymce.init({selector:"textarea",base_url:"../dist/tinymce/",convert_urls:!1,height:"150",suffix:".min",language:this.translate.instant("lang.langISO").replace("-","_"),language_url:`../dist/tinymce-i18n/langs/${this.translate.instant("lang.langISO").replace("-","_")}.js`,menubar:!1,statusbar:!1,readonly:e,plugins:["autolink"],extended_valid_elements:"script[src|async|defer|type|charset]",external_plugins:{maarch_b64image:"../tinymce/maarch_b64image/plugin.min.js"},toolbar_sticky:!0,toolbar_mode:"floating",toolbar:e?"":"undo redo | fontselect fontsizeselect | bold italic underline strikethrough forecolor | maarch_b64image |         alignleft aligncenter alignright alignjustify         bullist numlist outdent indent | removeformat"})}getInfoToInstall(){return[{idStep:"createCustom",body:{lang:this.appWelcome.stepFormGroup.controls.lang.value,customId:this.stepFormGroup.controls.customId.value,applicationName:this.stepFormGroup.controls.appName.value},description:this.translate.instant("lang.stepInstanceActionDesc"),route:{method:"POST",url:"../rest/installer/custom"},installPriority:1},{idStep:"customization",body:{loginMessage:tinymce.get("loginMessage").getContent(),homeMessage:tinymce.get("homeMessage").getContent(),bodyLoginBackground:this.stepFormGroup.controls.bodyLoginBackground.value,logo:this.stepFormGroup.controls.uploadedLogo.value},description:this.translate.instant("lang.stepCustomizationActionDesc"),route:{method:"POST",url:"../rest/installer/customization"},installPriority:3}]}uploadTrigger(e,r){if(e.target.files&&e.target.files[0]){const a=this.canUploadFile(e.target.files[0],r);if(!0===a){const i=new FileReader;i.readAsDataURL(e.target.files[0]),i.onload=p=>{if("logo"===r)this.stepFormGroup.controls.uploadedLogo.setValue(p.target.result);else{const c=new Image;c.onload=h=>{h.target.width<1920||h.target.height<1080?this.notify.error(this.translate.instant("lang.badImageResolution",{value1:"1920x1080"})):(this.backgroundList.push({filename:p.target.result,url:p.target.result}),this.stepFormGroup.controls.bodyLoginBackground.setValue(p.target.result))},c.src=p.target.result}}}else this.notify.error(a)}}canUploadFile(e,r){const a="logo"!==r?["image/jpg","image/jpeg"]:["image/svg+xml"];if("logo"===r){if(e.size>5e6)return this.translate.instant("lang.maxFileSizeExceeded",{value1:"5mo"});if(-1===a.indexOf(e.type))return this.translate.instant("lang.onlyExtensionsAllowed",{value1:a.join(", ")})}else{if(e.size>1e7)return this.translate.instant("lang.maxFileSizeExceeded",{value1:"10mo"});if(-1===a.indexOf(e.type))return this.translate.instant("lang.onlyExtensionsAllowed",{value1:a.join(", ")})}return!0}logoURL(){return this.sanitizer.bypassSecurityTrustUrl(this.stepFormGroup.controls.uploadedLogo.value)}selectBg(e){this.stepFormGroup.controls.bodyLoginBackground.disabled||this.stepFormGroup.controls.bodyLoginBackground.setValue(e)}clickLogoButton(e){this.stepFormGroup.controls.uploadedLogo.disabled||e.click()}static#t=this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(d.sK),t.\u0275\u0275directiveInject(o.UntypedFormBuilder),t.\u0275\u0275directiveInject(_.g),t.\u0275\u0275directiveInject(Mt.DomSanitizer),t.\u0275\u0275directiveInject(R.GM),t.\u0275\u0275directiveInject(I.HttpClient),t.\u0275\u0275directiveInject(S),t.\u0275\u0275directiveInject(G.d))};static#e=this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-customization"]],inputs:{appDatabase:"appDatabase",appWelcome:"appWelcome"},features:[t.\u0275\u0275ProvidersFeature([R.GM])],decls:54,vars:36,consts:[[1,"stepContent"],[1,"stepContentTitle"],[1,"fas","fa-tools"],["role","alert",1,"alert-message","alert-message-info",2,"margin-top","30px","min-width","100%"],[2,"display","contents",3,"formGroup"],[1,"col-md-6"],["appearance","outline"],["matInput","","formControlName","customId"],[4,"ngIf"],["matInput","","formControlName","appName"],["name","loginMessage","id","loginMessage","formControlName","loginMessage",2,"padding-top","10px"],["name","homeMessage","id","homeMessage","formControlName","homeMessage",2,"padding-top","10px"],["matRipple","",2,"width","350px","background-size","100%","cursor","pointer"],[2,"width","100%",3,"src","click"],["type","file","name","files[]","accept","image/svg+xml",2,"display","none",3,"change"],["uploadLogo",""],[1,"backgroundList"],[1,"backgroundItem",2,"background","url(assets/bodylogin.jpg)","background-size","cover",3,"click"],["style","opacity: 0.3;","class","backgroundItem",3,"selected","disabled","background","click",4,"ngFor","ngForOf"],["style","opacity: 0.3;display: flex;align-items: center;justify-content: center;","class","backgroundItem",3,"click",4,"ngIf"],[1,"backgroundItem",2,"opacity","0.3",3,"click"],[1,"backgroundItem",2,"opacity","0.3","display","flex","align-items","center","justify-content","center",3,"click"],["type","file","name","files[]","accept","image/jpeg",2,"display","none",3,"change"],["uploadFile",""],[1,"fa","fa-plus",2,"font-size","30px","color","#666"]],template:function(r,a){if(1&r){const i=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",0)(1,"h2",1),t.\u0275\u0275element(2,"i",2),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div",3),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"form",4)(9,"div",5)(10,"mat-form-field",6)(11,"mat-label"),t.\u0275\u0275text(12),t.\u0275\u0275pipe(13,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(14,"input",7),t.\u0275\u0275elementStart(15,"mat-error"),t.\u0275\u0275template(16,Lt,3,3,"ng-container",8)(17,kt,3,3,"ng-container",8)(18,Pt,3,5,"ng-container",8)(19,wt,3,5,"ng-container",8),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(20,"mat-form-field",6)(21,"mat-label"),t.\u0275\u0275text(22),t.\u0275\u0275pipe(23,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(24,"input",9),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(25,"div"),t.\u0275\u0275text(26),t.\u0275\u0275pipe(27,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(28,"textarea",10)(29,"br")(30,"br"),t.\u0275\u0275elementStart(31,"div"),t.\u0275\u0275text(32),t.\u0275\u0275pipe(33,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(34,"textarea",11)(35,"br")(36,"br"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(37,"div",5)(38,"div"),t.\u0275\u0275text(39),t.\u0275\u0275pipe(40,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(41,"div")(42,"mat-card",12)(43,"img",13),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(i);const c=t.\u0275\u0275reference(45);return t.\u0275\u0275resetView(a.clickLogoButton(c))}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(44,"input",14,15),t.\u0275\u0275listener("change",function(c){return a.uploadTrigger(c,"logo")}),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275element(46,"br"),t.\u0275\u0275elementStart(47,"div"),t.\u0275\u0275text(48),t.\u0275\u0275pipe(49,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(50,"div",16)(51,"mat-card",17),t.\u0275\u0275listener("click",function(){return a.selectBg("assets/bodylogin.jpg")}),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(52,Vt,1,6,"mat-card",18)(53,Ot,4,0,"mat-card",19),t.\u0275\u0275elementEnd()()()()}2&r&&(t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(4,20,"lang.customization"),""),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(7,22,"lang.stepCustomization_desc")," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("formGroup",a.stepFormGroup),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(13,24,"lang.instanceId")),t.\u0275\u0275advance(4),t.\u0275\u0275property("ngIf",null==a.stepFormGroup.controls.customId.errors?null:a.stepFormGroup.controls.customId.errors.customExist),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",null==a.stepFormGroup.controls.customId.errors?null:a.stepFormGroup.controls.customId.errors.invalidCustomName),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",null==a.stepFormGroup.controls.customId.errors?null:a.stepFormGroup.controls.customId.errors.pattern),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",null==a.stepFormGroup.controls.customId.errors?null:a.stepFormGroup.controls.customId.errors.minlength),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(23,26,"lang.applicationName")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(27,28,"lang.loginMsg")," : "),t.\u0275\u0275advance(6),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(33,30,"lang.homeMsg")," : "),t.\u0275\u0275advance(7),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(40,32,"lang.chooseLogo")," : "),t.\u0275\u0275advance(4),t.\u0275\u0275property("src",a.logoURL(),t.\u0275\u0275sanitizeUrl),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(49,34,"lang.chooseLoginBg")," : "),t.\u0275\u0275advance(3),t.\u0275\u0275classProp("disabled",a.stepFormGroup.controls.bodyLoginBackground.disabled)("selected","assets/bodylogin.jpg"===a.stepFormGroup.controls.bodyLoginBackground.value),t.\u0275\u0275advance(),t.\u0275\u0275property("ngForOf",a.backgroundList),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",!a.stepFormGroup.controls.bodyLoginBackground.disabled))},dependencies:[g.NgForOf,g.NgIf,o.\u0275NgNoValidate,o.DefaultValueAccessor,o.NgControlStatus,o.NgControlStatusGroup,o.FormGroupDirective,o.FormControlName,u.MatLegacyError,u.MatLegacyFormField,u.MatLegacyLabel,L.MatLegacyInput,Gt.MatLegacyCard,M.MatRipple,d.X$],styles:[".stepContent[_ngcontent-%COMP%]{margin:auto}.stepContent[_ngcontent-%COMP%]   .stepContentTitle[_ngcontent-%COMP%]{color:var(--maarch-color-primary);margin-bottom:30px;border-bottom:solid 1px;padding:0}.backgroundList[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);grid-gap:10px}.selected[_ngcontent-%COMP%]{transition:all .3s;opacity:1!important;border:solid 10px var(--maarch-color-secondary)!important}.backgroundItem[_ngcontent-%COMP%]{border:solid 0px var(--maarch-color-secondary);opacity:.5;transition:all .3s;cursor:pointer;height:120px;background-size:cover!important}.disabled[_ngcontent-%COMP%]{cursor:default!important}.backgroundItem[_ngcontent-%COMP%]:not(.disabled):hover{transition:all .3s;opacity:1!important}"]})}return n})(),At=(()=>{class n{constructor(e,r,a,i){this.translate=e,this._formBuilder=r,this.notify=a,this.installerService=i,this.tiggerInstall=new t.EventEmitter,this.hide=!0;const p=[o.Validators.pattern(/^[\w.@-]*$/),o.Validators.required],c=[o.Validators.pattern(/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/),o.Validators.required];this.stepFormGroup=this._formBuilder.group({login:["superadmin",p],firstname:["Admin",o.Validators.required],lastname:["SUPER",o.Validators.required],password:["",o.Validators.required],passwordConfirm:["",o.Validators.required],email:["yourEmail@domain.com",c]})}ngOnInit(){this.stepFormGroup.controls.password.valueChanges.pipe((0,m.b)(e=>{e!==this.stepFormGroup.controls.passwordConfirm.value?(this.stepFormGroup.controls.password.setErrors({incorrect:!0}),this.stepFormGroup.controls.passwordConfirm.setErrors({incorrect:!0}),this.stepFormGroup.controls.passwordConfirm.markAsTouched()):(this.stepFormGroup.controls.password.setErrors(null),this.stepFormGroup.controls.passwordConfirm.setErrors(null))})).subscribe(),this.stepFormGroup.controls.passwordConfirm.valueChanges.pipe((0,m.b)(e=>{e!==this.stepFormGroup.controls.password.value?(this.stepFormGroup.controls.password.setErrors({incorrect:!0}),this.stepFormGroup.controls.password.markAsTouched(),this.stepFormGroup.controls.passwordConfirm.setErrors({incorrect:!0})):(this.stepFormGroup.controls.password.setErrors(null),this.stepFormGroup.controls.passwordConfirm.setErrors(null))})).subscribe()}initStep(){this.installerService.isStepAlreadyLaunched("userAdmin")&&this.stepFormGroup.disable()}isValidStep(){return void 0!==this.stepFormGroup&&(this.stepFormGroup.valid||this.installerService.isStepAlreadyLaunched("userAdmin"))}getFormGroup(){return!!this.installerService.isStepAlreadyLaunched("userAdmin")||this.stepFormGroup}getInfoToInstall(){return[{idStep:"userAdmin",body:{login:this.stepFormGroup.controls.login.value,firstname:this.stepFormGroup.controls.firstname.value,lastname:this.stepFormGroup.controls.lastname.value,password:this.stepFormGroup.controls.password.value,email:this.stepFormGroup.controls.email.value},route:{method:"PUT",url:"../rest/installer/administrator"},description:this.translate.instant("lang.stepUserAdminActionDesc"),installPriority:3}]}launchInstall(){this.tiggerInstall.emit()}static#t=this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(d.sK),t.\u0275\u0275directiveInject(o.UntypedFormBuilder),t.\u0275\u0275directiveInject(_.g),t.\u0275\u0275directiveInject(S))};static#e=this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-useradmin"]],outputs:{tiggerInstall:"tiggerInstall"},decls:49,vars:39,consts:[[1,"stepContent"],[1,"stepContentTitle"],[1,"fas","fa-user"],["role","alert",1,"alert-message","alert-message-info",2,"margin-top","30px","min-width","100%"],[2,"width","850px","margin","auto",3,"formGroup"],["appearance","outline"],["matInput","","formControlName","login"],["matInput","","formControlName","firstname"],["matInput","","formControlName","lastname"],["matInput","","formControlName","password",3,"type"],["mat-icon-button","","matSuffix","","color","primary",3,"click"],["matInput","","formControlName","passwordConfirm",3,"type"],["matInput","","formControlName","email"]],template:function(r,a){1&r&&(t.\u0275\u0275elementStart(0,"div",0)(1,"h2",1),t.\u0275\u0275element(2,"i",2),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div",3),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"form",4)(9,"mat-form-field",5)(10,"mat-label"),t.\u0275\u0275text(11),t.\u0275\u0275pipe(12,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(13,"input",6),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(14,"mat-form-field",5)(15,"mat-label"),t.\u0275\u0275text(16),t.\u0275\u0275pipe(17,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(18,"input",7),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(19,"mat-form-field",5)(20,"mat-label"),t.\u0275\u0275text(21),t.\u0275\u0275pipe(22,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(23,"input",8),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(24,"mat-form-field",5)(25,"mat-label"),t.\u0275\u0275text(26),t.\u0275\u0275pipe(27,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(28,"input",9),t.\u0275\u0275elementStart(29,"button",10),t.\u0275\u0275listener("click",function(){return a.hide=!a.hide}),t.\u0275\u0275element(30,"mat-icon"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(31,"mat-error"),t.\u0275\u0275text(32),t.\u0275\u0275pipe(33,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(34,"mat-form-field",5)(35,"mat-label"),t.\u0275\u0275text(36),t.\u0275\u0275pipe(37,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(38,"input",11),t.\u0275\u0275elementStart(39,"button",10),t.\u0275\u0275listener("click",function(){return a.hide=!a.hide}),t.\u0275\u0275element(40,"mat-icon"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(41,"mat-error"),t.\u0275\u0275text(42),t.\u0275\u0275pipe(43,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(44,"mat-form-field",5)(45,"mat-label"),t.\u0275\u0275text(46),t.\u0275\u0275pipe(47,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(48,"input",12),t.\u0275\u0275elementEnd()()()),2&r&&(t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(4,19,"lang.userAdmin"),""),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(7,21,"lang.stepUserAdmin_desc")," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("formGroup",a.stepFormGroup),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(12,23,"lang.id")),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(17,25,"lang.firstname")),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(22,27,"lang.lastname")),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(27,29,"lang.password")),t.\u0275\u0275advance(2),t.\u0275\u0275property("type",a.hide?"password":"text"),t.\u0275\u0275advance(2),t.\u0275\u0275classMapInterpolate1("fa ",a.hide?"fa-eye-slash":"fa-eye",""),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(33,31,"lang.passwordNotMatch")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(37,33,"lang.retypeNewPassword")),t.\u0275\u0275advance(2),t.\u0275\u0275property("type",a.hide?"password":"text"),t.\u0275\u0275advance(2),t.\u0275\u0275classMapInterpolate1("fa ",a.hide?"fa-eye-slash":"fa-eye",""),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(43,35,"lang.passwordNotMatch")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(47,37,"lang.email")))},dependencies:[o.\u0275NgNoValidate,o.DefaultValueAccessor,o.NgControlStatus,o.NgControlStatusGroup,o.FormGroupDirective,o.FormControlName,u.MatLegacyError,u.MatLegacyFormField,u.MatLegacyLabel,u.MatLegacySuffix,L.MatLegacyInput,b.MatLegacyButton,E.MatIcon,d.X$],styles:[".stepContent[_ngcontent-%COMP%]{margin:auto}.stepContent[_ngcontent-%COMP%]   .stepContentTitle[_ngcontent-%COMP%]{color:var(--maarch-color-primary);margin-bottom:30px;border-bottom:solid 1px;padding:0}"]})}return n})();const Nt=["stepper"],zt=["stepContent"];function Dt(n,l){1&n&&t.\u0275\u0275text(0,"Installation")}function Ut(n,l){if(1&n){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",33),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(a.gotToLogin())}),t.\u0275\u0275pipe(1,"translate"),t.\u0275\u0275element(2,"mat-icon",34),t.\u0275\u0275elementEnd()}2&n&&t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(1,1,"lang.home"))}function $t(n,l){1&n&&(t.\u0275\u0275text(0),t.\u0275\u0275pipe(1,"translate")),2&n&&t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(1,1,"lang.prerequisite"))}function qt(n,l){1&n&&(t.\u0275\u0275text(0),t.\u0275\u0275pipe(1,"translate")),2&n&&t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(1,1,"lang.database"))}function Rt(n,l){1&n&&(t.\u0275\u0275text(0),t.\u0275\u0275pipe(1,"translate")),2&n&&t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(1,1,"lang.docserver"))}function Kt(n,l){1&n&&(t.\u0275\u0275text(0),t.\u0275\u0275pipe(1,"translate")),2&n&&t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(1,1,"lang.customization"))}function Wt(n,l){1&n&&(t.\u0275\u0275text(0),t.\u0275\u0275pipe(1,"translate")),2&n&&t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(1,1,"lang.userAdmin"))}function Ht(n,l){1&n&&t.\u0275\u0275element(0,"mat-icon",35)}function Qt(n,l){1&n&&t.\u0275\u0275element(0,"mat-icon",35)}function Xt(n,l){1&n&&t.\u0275\u0275element(0,"mat-icon",36)}function Zt(n,l){if(1&n){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-horizontal-stepper",6,7),t.\u0275\u0275listener("selectionChange",function(a){t.\u0275\u0275restoreView(e);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.initStep(a))}),t.\u0275\u0275elementStart(2,"mat-step",8),t.\u0275\u0275template(3,Dt,1,0,"ng-template",9),t.\u0275\u0275elementStart(4,"div",10)(5,"div",11),t.\u0275\u0275element(6,"app-welcome",null,12),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(9,Ut,3,3,"button",13),t.\u0275\u0275elementStart(10,"button",14),t.\u0275\u0275pipe(11,"translate"),t.\u0275\u0275element(12,"mat-icon",15),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(13,"mat-step",16),t.\u0275\u0275template(14,$t,2,3,"ng-template",9),t.\u0275\u0275elementStart(15,"div",10)(16,"div",11),t.\u0275\u0275element(17,"app-prerequisite",null,17),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(20,"button",18),t.\u0275\u0275pipe(21,"translate"),t.\u0275\u0275element(22,"mat-icon",19),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(23,"button",20),t.\u0275\u0275pipe(24,"translate"),t.\u0275\u0275element(25,"mat-icon",15),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(26,"mat-step",16),t.\u0275\u0275template(27,qt,2,3,"ng-template",9),t.\u0275\u0275elementStart(28,"div",10)(29,"div",11)(30,"app-database",21,22),t.\u0275\u0275listener("nextStep",function(){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.nextStep())}),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(33,"button",18),t.\u0275\u0275pipe(34,"translate"),t.\u0275\u0275element(35,"mat-icon",19),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(36,"button",20),t.\u0275\u0275pipe(37,"translate"),t.\u0275\u0275element(38,"mat-icon",15),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(39,"mat-step",16),t.\u0275\u0275template(40,Rt,2,3,"ng-template",9),t.\u0275\u0275elementStart(41,"div",10)(42,"div",11)(43,"app-docservers",21,23),t.\u0275\u0275listener("nextStep",function(){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.nextStep())}),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(46,"button",18),t.\u0275\u0275pipe(47,"translate"),t.\u0275\u0275element(48,"mat-icon",19),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(49,"button",20),t.\u0275\u0275pipe(50,"translate"),t.\u0275\u0275element(51,"mat-icon",15),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(52,"mat-step",16),t.\u0275\u0275template(53,Kt,2,3,"ng-template",9),t.\u0275\u0275elementStart(54,"div",10)(55,"div",11),t.\u0275\u0275element(56,"app-customization",24,25),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(59,"button",18),t.\u0275\u0275pipe(60,"translate"),t.\u0275\u0275element(61,"mat-icon",19),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(62,"button",20),t.\u0275\u0275pipe(63,"translate"),t.\u0275\u0275element(64,"mat-icon",15),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(65,"mat-step",16),t.\u0275\u0275template(66,Wt,2,3,"ng-template",9),t.\u0275\u0275elementStart(67,"div",10)(68,"div",11)(69,"app-useradmin",26,27),t.\u0275\u0275listener("tiggerInstall",function(){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.endInstall())}),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(72,"button",18),t.\u0275\u0275pipe(73,"translate"),t.\u0275\u0275element(74,"mat-icon",19),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(75,"button",28),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.endInstall())}),t.\u0275\u0275pipe(76,"translate"),t.\u0275\u0275element(77,"mat-icon",29),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275template(78,Ht,1,0,"ng-template",30)(79,Qt,1,0,"ng-template",31)(80,Xt,1,0,"ng-template",32),t.\u0275\u0275elementEnd()}if(2&n){const e=t.\u0275\u0275reference(8),r=t.\u0275\u0275reference(18),a=t.\u0275\u0275reference(31),i=t.\u0275\u0275reference(44),p=t.\u0275\u0275reference(57),c=t.\u0275\u0275reference(70),h=t.\u0275\u0275nextContext();t.\u0275\u0275property("@.disabled",!0),t.\u0275\u0275advance(9),t.\u0275\u0275property("ngIf",!h.authService.noInstall),t.\u0275\u0275advance(),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(11,25,"lang.next")),t.\u0275\u0275advance(3),t.\u0275\u0275property("stepControl",r.getFormGroup()),t.\u0275\u0275advance(7),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(21,27,"lang.previous")),t.\u0275\u0275advance(3),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(24,29,"lang.next"))("disabled",!r.isValidStep()),t.\u0275\u0275advance(3),t.\u0275\u0275property("stepControl",a.getFormGroup()),t.\u0275\u0275advance(7),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(34,31,"lang.previous")),t.\u0275\u0275advance(3),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(37,33,"lang.next"))("disabled",!a.isValidStep()),t.\u0275\u0275advance(3),t.\u0275\u0275property("stepControl",i.getFormGroup()),t.\u0275\u0275advance(7),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(47,35,"lang.previous")),t.\u0275\u0275advance(3),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(50,37,"lang.next"))("disabled",!i.isValidStep()),t.\u0275\u0275advance(3),t.\u0275\u0275property("stepControl",p.getFormGroup()),t.\u0275\u0275advance(4),t.\u0275\u0275property("appDatabase",a)("appWelcome",e),t.\u0275\u0275advance(3),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(60,39,"lang.previous")),t.\u0275\u0275advance(3),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(63,41,"lang.next"))("disabled",!p.isValidStep()),t.\u0275\u0275advance(3),t.\u0275\u0275property("stepControl",c.getFormGroup()),t.\u0275\u0275advance(7),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(73,43,"lang.previous")),t.\u0275\u0275advance(3),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(76,45,"lang.beginInstall"))("disabled",!c.isValidStep())}}const Yt=[{path:"",component:(()=>{class n{constructor(e,r,a,i,p,c,h,F,V,k){this.translate=e,this.router=r,this.headerService=a,this.notify=i,this.appService=p,this.sortPipe=c,this.dialog=h,this.functionService=F,this.privilegeService=V,this.authService=k,this.loading=!0}ngOnInit(){this.headerService.hideSideBar=!0,this.authService.isAuth()||this.authService.noInstall?null===this.authService.getToken()||this.privilegeService.hasCurrentUserPrivilege("create_custom")?this.loading=!1:(this.router.navigate(["/login"]),this.notify.error(this.translate.instant("lang.mustPrivilegeToInstall"))):(this.router.navigate(["/login"]),this.notify.error(this.translate.instant("lang.mustConnectToInstall")))}ngAfterViewInit(){$(".mat-horizontal-stepper-header-container").insertBefore(".bg-head-content"),$(".mat-step-icon").css("background-color","white"),$(".mat-step-icon").css("color","#135f7f"),$(".mat-step-label").css("color","white")}isValidStep(){return!1}initStep(e){this.stepContent.toArray()[e.selectedIndex].initStep()}nextStep(){this.stepper.next()}gotToLogin(){this.router.navigate(["/login"])}endInstall(){let e=[];this.stepContent.toArray().forEach(a=>{e=e.concat(a.getInfoToInstall())}),e=this.sortPipe.transform(e,"installPriority"),this.dialog.open(at,{panelClass:"maarch-modal",disableClose:!0,width:"500px",data:e}).afterClosed().pipe((0,T.h)(a=>!this.functionService.empty(a)),(0,m.b)(()=>{}),(0,v.K)(a=>(this.notify.handleErrors(a),(0,f.of)(!1)))).subscribe()}static#t=this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(d.sK),t.\u0275\u0275directiveInject(B.Router),t.\u0275\u0275directiveInject(rt.r),t.\u0275\u0275directiveInject(_.g),t.\u0275\u0275directiveInject(ot.z),t.\u0275\u0275directiveInject(j.U),t.\u0275\u0275directiveInject(y.MatLegacyDialog),t.\u0275\u0275directiveInject(G.d),t.\u0275\u0275directiveInject(it.x),t.\u0275\u0275directiveInject(P.e))};static#e=this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["ng-component"]],viewQuery:function(r,a){if(1&r&&(t.\u0275\u0275viewQuery(Nt,5),t.\u0275\u0275viewQuery(zt,5)),2&r){let i;t.\u0275\u0275queryRefresh(i=t.\u0275\u0275loadQuery())&&(a.stepper=i.first),t.\u0275\u0275queryRefresh(i=t.\u0275\u0275loadQuery())&&(a.stepContent=i)}},features:[t.\u0275\u0275ProvidersFeature([{provide:H.STEPPER_GLOBAL_OPTIONS,useValue:{showError:!0}},j.U])],decls:7,vars:5,consts:[["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-content"],[1,"container"],[1,"container-content",2,"overflow","hidden"],["linear","","style","height: 100vh;overflow: auto;",3,"selectionChange",4,"ngIf"],["linear","",2,"height","100vh","overflow","auto",3,"selectionChange"],["stepper",""],["label","install"],["matStepLabel",""],[1,"stepContainer"],[1,"stepContent"],["stepContent","","appWelcome",""],["mat-fab","","class","previousStepButton","color","primary",3,"title","click",4,"ngIf"],["mat-fab","","matStepperNext","","color","primary",1,"nextStepButton",3,"title"],[1,"fa","fa-arrow-right"],[3,"stepControl"],["appPrerequisite","","stepContent",""],["mat-fab","","matStepperPrevious","","color","primary",1,"previousStepButton",3,"title"],[1,"fa","fa-arrow-left"],["mat-fab","","matStepperNext","","color","primary",1,"nextStepButton",3,"title","disabled"],[3,"nextStep"],["appDatabase","","stepContent",""],["appDocservers","","stepContent",""],[3,"appDatabase","appWelcome"],["appCustomization","","stepContent",""],[3,"tiggerInstall"],["appUseradmin","","stepContent",""],["mat-fab","","color","accent",1,"nextStepButton",3,"title","disabled","click"],[1,"fas","fa-check-double"],["matStepperIcon","edit"],["matStepperIcon","done"],["matStepperIcon","error"],["mat-fab","","color","primary",1,"previousStepButton",3,"title","click"],[1,"fas","fa-home"],[1,"fa","fa-check","stepIcon"],[1,"fa","fa-times","stepIcon",2,"color","red","font-size","15px !important"]],template:function(r,a){1&r&&(t.\u0275\u0275elementStart(0,"mat-sidenav-container",0)(1,"mat-sidenav-content")(2,"div",1),t.\u0275\u0275element(3,"div",2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"div",3)(5,"div",4),t.\u0275\u0275template(6,Zt,81,47,"mat-horizontal-stepper",5),t.\u0275\u0275elementEnd()()()()),2&r&&(t.\u0275\u0275advance(3),t.\u0275\u0275classProp("fullContainer",a.appService.getViewMode()),t.\u0275\u0275advance(),t.\u0275\u0275classProp("fullContainer",a.appService.getViewMode()),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!a.loading))},dependencies:[g.NgIf,z.MatSidenavContainer,z.MatSidenavContent,b.MatLegacyButton,E.MatIcon,x.MatStep,x.MatStepLabel,x.MatStepper,x.MatStepperNext,x.MatStepperPrevious,x.MatStepperIcon,ut,bt,St,xt,jt,At,d.X$],styles:[".mat-stepper-horizontal{height:100%!important}.container[_ngcontent-%COMP%]{padding-left:80px!important;padding-right:80px!important}.previousStepButton[_ngcontent-%COMP%]{position:fixed;top:50%;left:10px;transform:translateY(-50%)}.previousStepButton[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:25px;height:auto;width:auto}.nextStepButton[_ngcontent-%COMP%]{position:fixed;top:50%;right:13px;transform:translateY(-50%)}.nextStepButton[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:25px;height:auto;width:auto}  .mat-step-icon{background-color:#fff;color:#135f7f}  .mat-step-label-active{opacity:1!important}  .mat-step-label{color:#fff;opacity:.5}.stepIcon[_ngcontent-%COMP%]{font-size:10px!important;height:auto!important;width:auto!important}  .mat-step-label{transition:all .2s}  .mat-step-label-selected{font-size:160%;transition:all .2s;opacity:1}"]})}return n})()}];let Jt=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=t.\u0275\u0275defineNgModule({type:n});static#n=this.\u0275inj=t.\u0275\u0275defineInjector({imports:[B.RouterModule.forChild(Yt),B.RouterModule]})}return n})(),te=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=t.\u0275\u0275defineNgModule({type:n});static#n=this.\u0275inj=t.\u0275\u0275defineInjector({providers:[S],imports:[W.m,d.aw,Jt]})}return n})()}}]);